var wpContact = { _companyId: 0, Configs: { HANDLER_CALLBACK_CONTACT_URL: "/Modules/PriceComparison/Handler/Contact.ashx" }, Utils: { IsValidEmail: function (t) { var a = /^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.([a-z]){2,4})$/; return a.test(t) } }, selectors: { ITEM_RANK_SENDCONTACT: "#send_contact", ITEM_RANK_CACELCONTACT: "#cacel_contact" }, sendContact: function () { var t = document.getElementById("ddlContactGroup"), a = t.options[t.selectedIndex].value, n = $("#tbName"), e = $("#tbEmail"), l = $("#tbPhoneNumber"), c = $("#tbAdress"), o = $("#tbContent"), s = wpContact.Utils.IsValidEmail(e.val()), u = $("#txtCaptcha"); return null == a || 0 == a ? (alert("Bạn phải chọn nhóm liên hệ!"), !1) : null == n.val() || "" == n.val() ? (alert("Bạn phải nhập tiêu đề cho liên hệ!"), n.focus(), !1) : null == e.val() || "" == e.val() ? (alert("Bạn phải nhập email !!!"), e.focus(), !1) : 0 == s ? (alert("Địa chỉ email không hợp lệ !!!"), e.focus(), !1) : null == l.val() || "" == l.val() ? (alert("Bạn phải nhập số điện thoại !!!"), l.focus(), !1) : null == c.val() || "" == c.val() ? (c("Bạn phải nhập địa chỉ !"), c.focus(), !1) : null == o.val() || "" == o.val() ? (alert("Bạn phải nhập nội dung !"), o.focus(), !1) : null == u.val() || "" == u.val() ? (alert("Bạn phải nhập mã bảo mật !"), u.focus(), !1) : void $.ajax({ type: "POST", data: { method: "ContactCompany", args: { companyId: wpContact._companyId, txtName: n.val(), txtPhoneNumber: l.val(), txtAddress: c.val(), ddlContactGroup: a, txtEmail: e.val(), content: o.val(), captcha: u.val() } }, url: wpContact.Configs.HANDLER_CALLBACK_CONTACT_URL, success: function (t) { var a = $.parseJSON(t); switch (a.status) { case "success": wpContact.clearContact(), alert("Bạn đã gửi liên hệ thành công !!!"); break; case "error": alert(res.message + res.data); break; case "fail": alert("Hệ thống đang quá tải, bạn vui lòng quay lại sau !!!") } }, error: function (t, a) { alert(a) } }) }, clearContact: function () { document.getElementById("ddlContactGroup").selectedIndex = 0, document.getElementById("tbName").value = "", document.getElementById("tbEmail").value = "", document.getElementById("tbPhoneNumber").value = "", document.getElementById("tbAdress").value = "", document.getElementById("tbContent").value = "", document.getElementById("txtCaptcha").value = "" }, init: function (t) { var a = this; wpContact._companyId = t, $(a.selectors.ITEM_RANK_SENDCONTACT).click(function () { wpContact.sendContact() }), $(a.selectors.ITEM_RANK_CACELCONTACT).click(function () { wpContact.clearContact() }) } };